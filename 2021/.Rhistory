mover_sum%>% group_by(var_name,var_value,)%>%mutate(share_covid_mover=count/sum(count))
mover_sum%>% group_by(covid_mover)%>%mutate(share_covid_mover=count/sum(count))
mover_sum%>% group_by(var_name,var_value)%>%mutate(share_covid_mover=count/sum(count))
mover_sum%>% pivot_wider(names_from=covid_mover, values_from=count)
mover_sum%>%group_by(var_name, covid_mover)%>%mutate(share_covid_mover=count/sum(count))
hhs_2021<-get_hhts(dyear=2019, level="h", vars=c("res_dur",
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify"
))%>%mutate(covid_mover=factor(case_when(res_dur=="Less than a year" ~1, !is.na(res_dur) ~0)))
vars_to_summarize<-c(
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify")
mover_sum<- list()
mover_sum <- lapply(vars_to_summarize, FUN=function(x) hhts_count(df=hhs_2021,group_vars=c(x, "covid_mover"))) %>%
lapply(FUN=function(y){mutate(y, "var_name"=colnames(y)[1])}) %>% rbindlist(use.names=FALSE) %>%
rename(var_value=colnames(.)[1]) %>% relocate(var_name)%>%filter(covid_mover!='Total')
mover_sum%>% pivot_wider(names_from=c(var_value,covid_mover), values_from=count)%>%group_by(var_name,var_value)%>%mutate(share_covid_mover=count/sum(count))
mover_sum%>% pivot_wider(names_from=c(var_value,covid_mover), values_from=count)%>%group_by(var_name%>%mutate(share_covid_mover=count/sum(count)))
mover_sum%>% pivot_wider(names_from=c(var_value,covid_mover), values_from=count)
mover_sum%>% pivot_wider(names_from=c(,covid_mover), values_from=count)
mover_sum%>% pivot_wider(names_from=c(covid_mover), values_from=count)%>%group_by(var_name,var_value)%>%mutate('COVID mover' = sum('1'), 'Pre-COVID mover' = sum('0'))
mover_sum%>% pivot_wider(names_from=c(covid_mover), values_from=count,names_prefix='COVID') %>%group_by(var_name,var_value)%>%mutate('COVID mover' = sum(COVID1), 'Pre_COVID_mover' = sum(COVID0))
mover_sum%>% select(var_name, var_value, covid_mover, count)%>%pivot_wider(names_from=c(covid_mover), values_from=count,names_prefix='COVID')
mover_sum%>% select(var_name, var_value, covid_mover, count)%>%pivot_wider(names_from=c(covid_mover), values_from=count,names_prefix='COVID') %>%group_by(var_name,var_value)%>%mutate('COVID_mover_share' = COVID1/sum(COVID1), 'Pre_COVID_mover_share' = COVID0/sum(COVID0))
mover_sum%>% select(var_name, var_value, covid_mover, count)%>%pivot_wider(names_from=c(covid_mover), values_from=count,names_prefix='COVID') %>%group_by(var_name,var_value)%>%mutate('COVID_mover_share' = COVID1/sum(COVID1), 'Pre_COVID_mover_share' = COVID0/sum(COVID0))%>%ungroup
mover_sum%>% select(var_name, var_value, covid_mover, count)%>%pivot_wider(names_from=c(covid_mover), values_from=count,names_prefix='COVID') %>%group_by(var_name,var_value)%>%mutate(COVID_mover_share= prop.table(COVID1),PreCOVID_mover_share= prop.table(COVID0))
knitr::opts_chunk$set(echo = TRUE)
library(psrc.travelsurvey)
library(dplyr)
library(stringr)
library(data.table)
res_dur_2019<-get_hhts(dyear=2019, level="h", vars="res_dur")
res_dur_2019_counts<- hhts_count(df=res_dur_2019, group_vars='res_dur')
res_dur_2021<-get_hhts(dyear=2021, level="h", vars="res_dur")
res_dur_2021_counts<- hhts_count(df=res_dur_2021, group_vars='res_dur')
res_dur_2019_2021_counts<-merge(res_dur_2019_counts, res_dur_2021_counts, by='res_dur', suffixes =c('2019', '2021'))
write.table(res_dur_2019_2021_counts, "clipboard", sep="\t", row.names=FALSE)
res_dur_2019_2021_counts
hhs_2021<-get_hhts(dyear=2019, level="h", vars=c("res_dur",
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify"
))%>%mutate(covid_mover=factor(case_when(res_dur=="Less than a year" ~1, !is.na(res_dur) ~0)))
vars_to_summarize<-c(
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify")
mover_sum<- list()
mover_sum <- lapply(vars_to_summarize, FUN=function(x) hhts_count(df=hhs_2021,group_vars=c(x, "covid_mover"))) %>%
lapply(FUN=function(y){mutate(y, "var_name"=colnames(y)[1])}) %>% rbindlist(use.names=FALSE) %>%
rename(var_value=colnames(.)[1]) %>% relocate(var_name)%>%filter(covid_mover!='Total')
mover_sum%>% select(var_name, var_value, covid_mover, count)%>%pivot_wider(names_from=c(covid_mover), values_from=count,names_prefix='COVID') %>%group_by(var_name,var_value)%>%mutate('COVID_mover_share' = COVID1/sum(COVID1), 'Pre_COVID_mover_share' = COVID0/sum(COVID0))
library(tidyr)
hhs_2021<-get_hhts(dyear=2019, level="h", vars=c("res_dur",
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify"
))%>%mutate(covid_mover=factor(case_when(res_dur=="Less than a year" ~1, !is.na(res_dur) ~0)))
vars_to_summarize<-c(
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify")
mover_sum<- list()
mover_sum <- lapply(vars_to_summarize, FUN=function(x) hhts_count(df=hhs_2021,group_vars=c(x, "covid_mover"))) %>%
lapply(FUN=function(y){mutate(y, "var_name"=colnames(y)[1])}) %>% rbindlist(use.names=FALSE) %>%
rename(var_value=colnames(.)[1]) %>% relocate(var_name)%>%filter(covid_mover!='Total')
mover_sum%>% select(var_name, var_value, covid_mover, count)%>%pivot_wider(names_from=c(covid_mover), values_from=count,names_prefix='COVID') %>%group_by(var_name,var_value)%>%mutate('COVID_mover_share' = COVID1/sum(COVID1), 'Pre_COVID_mover_share' = COVID0/sum(COVID0))
mover_sum%>% select(var_name, var_value, covid_mover, count)%>%pivot_wider(names_from=c(covid_mover), values_from=count,names_prefix='COVID') %>%group_by(var_name,var_value)%>%mutate('COVID_mover_share' = COVID1/sum(COVID1), 'Pre_COVID_mover_share' = COVID0/sum(COVID0))
mover_shares<-mover_sum%>% select(var_name, var_value, covid_mover, count)%>%pivot_wider(names_from=c(covid_mover), values_from=count,names_prefix='COVID') %>%group_by(var_name)%>%mutate('COVID_mover_share' = COVID1/sum(COVID1), 'Pre_COVID_mover_share' = COVID0/sum(COVID0))
View(mover_shares)
write.table(mover_shares, "clipboard", sep="\t", row.names=FALSE)
hhs_2021<-get_hhts(dyear=2019, level="h", vars=c("res_dur",
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify"
))%>%mutate(covid_mover=factor(case_when(res_dur=="Less than a year" ~1, res_dur=="Between 1 and 2 years"~2, res_dur=="Between 2 and 3 years"~3, res_dur=='Between 3 and 5 years' ~4, TRUE ~ 5)))
vars_to_summarize<-c(
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify")
mover_sum<- list()
mover_sum <- lapply(vars_to_summarize, FUN=function(x) hhts_count(df=hhs_2021,group_vars=c(x, "covid_mover"))) %>%
lapply(FUN=function(y){mutate(y, "var_name"=colnames(y)[1])}) %>% rbindlist(use.names=FALSE) %>%
rename(var_value=colnames(.)[1]) %>% relocate(var_name)%>%filter(covid_mover!='Total')
mover_shares<-mover_sum%>% select(var_name, var_value, covid_mover, count)%>%pivot_wider(names_from=c(covid_mover), values_from=count,names_prefix='COVID') %>%group_by(var_name)%>%mutate('COVID_mover_share' = COVID1/sum(COVID1), 'Moved_in_1_2_years' = COVID2/sum(COVID2),'Moved_2_3' = COVID3/sum(COVID3), 'Moved 3_5' = COVID4/sum(COVID4),)
write.table(mover_shares, "clipboard", sep="\t", row.names=FALSE)
```{r moved_recently}
hhs_2021<-get_hhts(dyear=2019, level="h", vars=c("res_dur",
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify"
))
vars_to_summarize<-c(
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify")
mover_sum<- list()
mover_sum <- lapply(vars_to_summarize, FUN=function(x) hhts_count(df=hhs_2021,group_vars=c(x, "res_dur"))) %>%
lapply(FUN=function(y){mutate(y, "var_name"=colnames(y)[1])}) %>% rbindlist(use.names=FALSE) %>%
rename(var_value=colnames(.)[1]) %>% relocate(var_name)%>%filter(res_dur!='Total')
View(mover_sum)
mover_shares<-mover_sum%>% select(var_name, var_value, covid_mover, count)%>%pivot_wider(names_from=c(res_dur), values_from=count,names_prefix='COVID')
mover_shares<-mover_sum%>% select(var_name, var_value, res_dur, count)%>%pivot_wider(names_from=c(res_dur), values_from=count,names_prefix='COVID')
View(mover_shares)
mover_shares<-mover_sum%>% select(var_name, var_value, res_dur, count)%>%pivot_wider(names_from=c(res_dur), values_from=count,names_prefix='res_dur')
View(mover_shares)
View(mover_shares)
write.table(mover_shares, "clipboard", sep="\t", row.names=FALSE)
mover_shares<-mover_sum%>% select(var_name, var_value, res_dur, count)%>%pivot_wider(names_from=c(res_dur), values_from=count,names_prefix='res_dur') %>%group_by(var_name,res_dur)%>%mutate(acoss(starts_with('res_dur'), .x/sum(.x)))
mover_shares<-mover_sum%>% select(var_name, var_value, res_dur, count)%>%pivot_wider(names_from=c(res_dur), values_from=count,names_prefix='res_dur') %>%group_by(var_name,res_dur)%>%mutate(across(starts_with("res_dur"), .x/sum(.x)))
mover_shares<-mover_sum%>% select(var_name, var_value, res_dur, count)%>%pivot_wider(names_from=c(res_dur), values_from=count,names_prefix='res_dur') %>%group_by(var_name)%>%mutate(across(starts_with("res_dur"), .x/sum(.x)))
mover_shares<-mover_sum%>% select(var_name, var_value, res_dur, count)%>%pivot_wider(names_from=c(res_dur), values_from=count,names_prefix='res_dur') %>%group_by(var_name)%>%mutate(across(starts_with("res_dur"),~ .x/sum(.x)))
View(mover_shares)
write.table(mover_shares, "clipboard", sep="\t", row.names=FALSE)
hhs_2021<-get_hhts(dyear=2021, level="h", vars=c("res_dur",
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify"
))
vars_to_summarize<-c(
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify")
mover_sum<- list()
mover_sum <- lapply(vars_to_summarize, FUN=function(x) hhts_count(df=hhs_2021,group_vars=c(x, "res_dur"))) %>%
lapply(FUN=function(y){mutate(y, "var_name"=colnames(y)[1])}) %>% rbindlist(use.names=FALSE) %>%
rename(var_value=colnames(.)[1]) %>% relocate(var_name)%>%filter(res_dur!='Total')
mover_shares<-mover_sum%>% select(var_name, var_value, res_dur, count)%>%pivot_wider(names_from=c(res_dur), values_from=count,names_prefix='res_dur') %>%group_by(var_name)%>%mutate(across(starts_with("res_dur"), .x/sum(.x)))
hhs_2021<-get_hhts(dyear=2021, level="h", vars=c("res_dur",
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify"
))
vars_to_summarize<-c(
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify")
mover_sum<- list()
mover_sum <- lapply(vars_to_summarize, FUN=function(x) hhts_count(df=hhs_2021,group_vars=c(x, "res_dur"))) %>%
lapply(FUN=function(y){mutate(y, "var_name"=colnames(y)[1])}) %>% rbindlist(use.names=FALSE) %>%
rename(var_value=colnames(.)[1]) %>% relocate(var_name)%>%filter(res_dur!='Total')
mover_shares<-mover_sum%>% select(var_name, var_value, res_dur, count)%>%pivot_wider(names_from=c(res_dur), values_from=count,names_prefix='res_dur') %>%group_by(var_name)%>%mutate(across(starts_with("res_dur"),~ .x/sum(.x)))
write.table(mover_shares, "clipboard", sep="\t", row.names=FALSE)
hhs_2021<-get_hhts(dyear=2019, level="h", vars=c("res_dur",
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify"
))
vars_to_summarize<-c(
"res_factors_30min",
"res_factors_afford",
"res_factors_closefam",
"res_factors_hwy",
"res_factors_school",
"res_factors_space",
"res_factors_transit",
"res_factors_walk",
"res_factors_cultural",
"prev_res_factors_housing_cost",
"prev_res_factors_income_change",
"prev_res_factors_community_change",
"prev_res_factors_hh_size",
"prev_res_factors_more_space",
"prev_res_factors_less_space",
"prev_res_factors_employment",
"prev_res_factors_covid_flexibility",
"prev_res_factors_school",
"prev_res_factors_crime",
"prev_res_factors_covid_health",
"prev_res_factors_quality",
"prev_res_factors_forced",
"prev_res_factors_no_answer",
"prev_res_factors_other",
"prev_res_factors_specify")
mover_sum<- list()
mover_sum <- lapply(vars_to_summarize, FUN=function(x) hhts_count(df=hhs_2021,group_vars=c(x, "res_dur"))) %>%
lapply(FUN=function(y){mutate(y, "var_name"=colnames(y)[1])}) %>% rbindlist(use.names=FALSE) %>%
rename(var_value=colnames(.)[1]) %>% relocate(var_name)%>%filter(res_dur!='Total')
mover_shares<-mover_sum%>% select(var_name, var_value, res_dur, count)%>%pivot_wider(names_from=c(res_dur), values_from=count,names_prefix='res_dur') %>%group_by(var_name)%>%mutate(across(starts_with("res_dur"),~ .x/sum(.x)))
write.table(mover_shares, "clipboard", sep="\t", row.names=FALSE)
