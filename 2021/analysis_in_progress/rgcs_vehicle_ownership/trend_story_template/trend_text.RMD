---
output: 
  pdf_document:
    latex_engine: lualatex
    includes:
      in_header: trend_format.tex
fontsize: 12pt
bibliography: reference.bib 
---


```{r setup, include=FALSE}

library(psrc.travelsurvey)
library(scales)
library(psrcplot)
library(psrccensus)
library(tidyverse)
library(knitr)
library(magick)
library(openxlsx)
library(tidycensus)

options(tinytex.verbose=TRUE)

opts_chunk$set(echo=FALSE, 
               warning=FALSE, 
               message=FALSE,
               fig.align = "center"
               # out.width = '50%'
               ) # formatting

install_psrc_fonts()

source("trend_processing.R")
```


![](C:/Users/JLin/Downloads/image.png){width=100%}

The 2021 regional travel survey collected day-to-day information from households in the central Puget Sound region: how we traveled, where we went, how long it took - even where we chose to live and whether we got home deliveries. This report compares household travel choices in 2021, during COVID-19 conditions to that in the previous years of 2017 and 2019. Learn more at the \href{https://www.psrc.org/our-work/household-travel-survey-program}{\underline{\textcolor{blue}{PSRC household travel survey webpage}}}. You can also \href{https://household-travel-survey-psregcncl.hub.arcgis.com}{\underline{\textcolor{blue}{view the full travel survey dataset here}}}, including 2017, 2019, and 2021 data.

# Regional Growth Centers in Central Puget Sound

Since the early 1990s, the central Puget Sound region has adopted a strategy that focus future population and employment growth in designated \href{https://www.psrc.org/our-work/centers}{\underline{\textcolor{blue}{centers}}} within the region's urban growth area. Currently, there are 29 dense, walkable, mixed-used areas called  \textbf{regional growth centers (RGCs)}, as well as into 9 dense concentrations of employment called  \textbf{regional manufacturing/industrial centers (MICs)}. RGCs are places that higher density and population and employment growth is planned. Based on the most recent findings in 2016, RGCs constitute only 1\% of the region's land area, but contain 5\% share of population and 28\% of employment, as well as 7\% of population growth and 12\% of employment growth. The main function of RGCs is to accommodate significant population and employment growth, as well as to focus regional's investments on housing, services and public transportation to accommodate the large demand that comes with the projected growth.


## RGC Demographics

Figure \@ref(plot_age) profiles the age of RGC residents. The data shows a higher percentage of 18- to 34-year-olds residing in RGCs, compared to the non-RGC areas. This hints RGCs' attraction to the young workforce, as RGCs offers more rental housing, employment and transit. Also, RGCs have fewer children than the non-RGC areas, while the share of seniors have the same share across RGCs and non-RGCs.

```{r plot_age, fig.cap= "Regional Growth Center Age", fig.dim=c(5,3)}
plot_age + labs(caption = "U.S. Census Bureau - American Community Survey, 2017-2021 Census Tract Estimates.")
```

Figure \@ref(hhsize) shows a share of 35% single-person households in RGCs and 26% of single-person households in non-RGCs, reflecting smaller household sizes in RGCs compared to non-RGCs. 

```{r hhsize, fig.cap= "Regional Growth Center Household Size", fig.dim=c(2,3.5)}
plot_hhsize + labs(caption = "U.S. Census Bureau - American Community Survey, 2017-2021 Census Tract Estimates.")

```



```{r income, fig.cap= "Regional Growth Center Household Income", fig.dim=c(4,3.5)}
plot_income + labs(caption = "U.S. Census Bureau - American Community Survey, 2017-2021 Census Tract Estimates.")
```

Across all RGCs, 

```{r v_own, fig.cap= "Regional Growth Center Vehicle Ownership", fig.dim=c(2,3.5)}
plot_veh_own + labs(caption = "U.S. Census Bureau - American Community Survey, 2017-2021 Census Tract Estimates.")
```



## Travel Behavior

This report applied 2017, 2019 and 2021 Household travel survey data to describe the travel behaviors of residents in RGCs and how their travel behavior is different than residents in other non-RGC areas.

To support projected growth in RGCs, the region's plans call for an efficient multi-modal transportation system that increases accessibility in the region. It is anticipated that the RGCs will be connected with high-capacity transit. In addition, a more efficient urban environment will be created to provide multiple travel choices, including walking, biking and taking transit.

### Mode shares

```{r mode share, fig.dim=c(6,4), fig.dim=c(6,4)}
# static_bar_chart(mode_rgc %>% filter(survey=="2021"), x = "share", y = "final_home_is_rgc",
# fill = "mode_simple2",pos="stack", color="pognbgy_5")


ggplot(mode_rgc %>% filter(survey=="2021"), 
       aes(x=fct_rev(final_home_is_rgc), y=share, fill=mode_simple2)) +
  geom_bar(position=position_stack(reverse = TRUE), stat="identity") +
  scale_y_continuous(labels = label_percent()) +
  psrc_style()+
  scale_fill_manual(values = psrc_colors$pognbgy_5) +
  coord_flip()

# ggplot(mode_metro %>% filter(survey=="2021"), 
#        aes(x=fct_rev(urban_metro), y=share, fill=mode_simple2)) +
#   geom_bar(position=position_stack(reverse = TRUE), stat="identity") + 
#   scale_y_continuous(labels = label_percent()) +
#   psrc_style()+
#   scale_fill_manual(values = psrc_colors$pognbgy_5) +
#   coord_flip()


# interactive_bar_chart(mode_rgc %>% filter(survey=="2021"), x = "share", y = "final_home_is_rgc",
#                       fill = "mode_simple2",pos="stack")
```

### Change in mode shares

```{r}
TT <- "Change in mode share in RGCs \n(2021 compared to 2017/2019 HHTS)"
ggplot(mode_change_rgc, aes(x=mode_simple2, y=share_change, fill=final_home_is_rgc)) +
  geom_col(position = "dodge")+
  geom_errorbar(aes(ymin=share_change-share_moe_change, ymax=share_change+share_moe_change),
                          width=0.2, position = position_dodge(0.9)) +
  scale_y_continuous(labels=percent,breaks=seq(-0.8,0.8,0.2)) +
  scale_fill_discrete_psrc ("pognbgy_10")+
  ggtitle(TT)+
  psrc_style2(text_size = 2)

# TT <- "Change in mode share in metro and urban RGCs \n(2021 compared to 2017/2019 HHTS)"
# ggplot(mode_change_metro, aes(x=mode_simple2, y=share_change, fill=urban_metro)) +
#   geom_col(position = "dodge")+
#   geom_errorbar(aes(ymin=share_change-share_moe_change, ymax=share_change+share_moe_change),
#                           width=0.2, position = position_dodge(0.9)) +
#   scale_y_continuous(labels=percent) +
#   scale_fill_discrete_psrc ("gnbopgy_5")+
#   ggtitle(TT)+
#   psrc_style2(text_size = 2)
```

### Trip travel time and trip distance

```{r}
TT <- "Average travel time and trip distance (2021 HHTS)"
ggplot(time_dist_rgc, 
       aes(x=final_home_is_rgc, y=mean, fill=final_home_is_rgc)) +
  geom_col(position = "dodge")+  
  geom_errorbar(aes(ymin=mean-mean_moe, 
                    ymax=mean+mean_moe),
                          width=0.2, position = position_dodge(0.9))+
  scale_fill_discrete_psrc ("pognbgy_10")+
  facet_wrap(~label, scales = "free_y") +
  ggtitle(TT)+
  psrc_style2(text_size = 2)

TT <- "Average travel time and trip distance (2021 HHTS)"
ggplot(time_dist_metro, 
       aes(x=urban_metro, y=mean, fill=urban_metro)) +
  geom_col(position = "dodge")+  
  geom_errorbar(aes(ymin=mean-mean_moe, 
                    ymax=mean+mean_moe),
                          width=0.2, position = position_dodge(0.9))+
  scale_fill_discrete_psrc ("gnbopgy_5")+
  facet_wrap(~label, scales = "free_y") +
  ggtitle(TT)+
  psrc_style2(text_size = 2)
```

### walk and transit frequency
```{r}
plot <- hhts_count(freq, 
                       group_vars=c("urban_metro", "transit_label"),
                       spec_wgt = "person_adult_weight_2021") %>%
  filter(transit_label!="Total") 
TT <- "Transit frequency (2021 HHTS)"
ggplot(plot, 
       aes(x=transit_label, y=share, fill=urban_metro)) +
  geom_col(position = "dodge")+  
  moe_bars+
  scale_y_continuous(labels=percent) +
  scale_fill_discrete_psrc ("gnbopgy_5")+
  ggtitle(TT)+
  psrc_style2(text_size = 2)

plot  <- hhts_count(freq, 
                    group_vars=c("urban_metro", "walk_label"),
                    spec_wgt = "person_adult_weight_2021") %>%
  filter(walk_label!="Total") 
TT <- "Walk frequency (2021 HHTS)"
ggplot(plot, 
       aes(x=walk_label, y=share, fill=urban_metro)) +
  geom_col(position = "dodge")+  
  moe_bars+
  scale_y_continuous(labels=percent) +
  scale_fill_discrete_psrc ("gnbopgy_5")+
  ggtitle(TT)+
  psrc_style2(text_size = 2)

```





<!-- ![](C:/GitHub/travel-studies/2021/trend-stories/bike-ped/walking_image_header.png){width=100%} -->
\begin{flushleft}
The 2021 regional travel survey collected day-to-day information from households in the central Puget Sound region: how we traveled, where we went, how long it took - even where we chose to live and whether we got home deliveries. This report compares household travel choices in 2021, during COVID-19 conditions to that in the previous years of 2017 and 2019. Learn more at the \href{https://www.psrc.org/our-work/household-travel-survey-program}{\underline{\textcolor{blue}{PSRC household travel survey webpage}}}. You can also \href{https://household-travel-survey-psregcncl.hub.arcgis.com}{\underline{\textcolor{blue}{view the full travel survey dataset here}}}, including 2017, 2019, and 2021 data.
\end{flushleft}



\subsection{Conclusion}
\begin{flushleft}
People were walking and biking more in 2021 than in previous years, but using transit less. COVID-19 conditions contributed to this substantial shift in behavior across most demographic groups. The 2023 household travel survey will show whether these patterns continue.
\end{flushleft}
